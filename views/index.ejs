<%- include('partials/header') %>

<div class="mb-3">
  <label for="exampleFormControlInput1" class="form-label">Email address</label>
  <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="name@example.com">
</div>
<div class="mb-3">
  <label for="exampleFormControlTextarea1" class="form-label">Example textarea</label>
  <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
</div>

<button id="checkout" class="btn btn-primary btn-block">Checkout</button>

<script>
    const stripe = Stripe("<%=STRIPE_PUBLIC%>");
    // document.cookie = "token=; Max-Age=0"
    function checkout()
    {
        return $.ajax({
            url: "/api/users/checkout",
            type: "get"
        });
    }

    $("#checkout").click(e => {
        (async () => {
            try
            {
                const session = await checkout();
                stripe.redirectToCheckout({ sessionId: session.id });
            }
            catch (error)
            {
                console.log(error);
            }
        })();
    });

</script>

<%- include('partials/footer') %>