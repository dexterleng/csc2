<%- include('../partials/header') %>

<div id="talent-container">

</div>

<div id="disqus_thread"></div>

<script>
  const talentId = "<%= talentId %>";
  const talentRepo = new TalentRepository();

  Promise.resolve()
      .then(() => setLoadingState())
      .then(() => talentRepo.find(talentId))
      .then(showTalent)
      .catch(showError);

  function setLoadingState() {
    $("#talent-container").empty();
    $("#talent-container").append(`
    <div class="spinner-border" role="status">
    </div>
    `);
  }

  // TODO: cut off description beyond a certain length
  function renderTalentCard(talent) {
    return `
<div class="card" style="width: 20rem;">
  <img class="card-img-top" src="${talent.profile_picture_url}">
  <div class="card-body">
    <h5 class="card-title">${talent.name}</h5>
    <p class="card-text">${talent.description}</p>
    <a href="/talents/${talent.id}" class="btn btn-primary">View Profile</a>
  </div>
</div>
    `;
  }

  function showTalent(talent) {
    $("#talent-container").empty();
    $("#talent-container").append(renderTalentCard(talent));
  }

  function showError(e) {
    let message = "Something went wrong."

    if (e.status) {
      message = `Network request failed with status ${e.status}`
    }

    $("#talent-container").empty();
    $("#talent-container").append(`
      <div class="alert alert-danger" role="alert">
        ${message}
      </div>
    `);
  }
</script>

<script>
  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
  var disqus_config = function () {
  this.page.url = '<%= disqusUrl %>';  // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = "<%= disqusUrl %>"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
  };

  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://<%= disqusShortname %>.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<%- include('../partials/footer') %>